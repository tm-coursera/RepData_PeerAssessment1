---
title: "Coursera Reproducible Research Assignment Week 2"
output: html_notebook
---

This report is written in a R notebook using Rstudio. 

To reproduces this notebook the following packages are called:

```{r results='hide'}
library(dplyr)
library(tidyr)

```


The file is downloaded from the [link](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip)
given in the assignment.

```{r results='hide'}
fileUrl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
download.file (fileUrl, destfile="activity.zip", method="curl")
```

After downloading, the file is needs to be unzipped before loading into R.  

```{r}
unzip('activity.zip', exdir=".")
```

## Loading and preprocessing the data

The data is loaded into a dataframe using read.csv.

```{r}
dfa <- read.csv("activity.csv", header=TRUE, stringsAsFactors = FALSE)
str(dfa)  

summary(dfa)
```

The data is ready to proces and doens't need further processing. 


## What is the mean total number of steps taken per day?
The total number of steps taken is `r sumsteps$totalsteps` and is calculated as the sum of 
the 'steps' columns. 

```{r}
sumsteps <- summarise(dfa, totalsteps=sum(steps, na.rm=TRUE))
```

To review the steps by day, the data is aggregated by day. A histogram is created 
to show the frequencies of steps taken daily.  

```{r}
stepsbyday <- dfa %>%
        group_by(date) %>%
        summarise(stepsbd=sum(steps, na.rm = TRUE))

hist(stepsbyday$stepsbd, xlab="Steps per day", main="Histogram of daily steps")
```

The mean (`r summarydf$meansteps`) and median (`r summarydf$mediansteps`) number
of steps taken daily are determined from the dataframe 'stepsbyday' created in 
the previous step. 


```{r}
summarydf <- summarise(stepsbyday,
        totalsteps=sum(stepsbd),
        meansteps=mean(stepsbd),
        mediansteps=median(stepsbd))

summarydf
```

## What is the average daily activity pattern?

To review the activity pattern by the 5 minute interval averaged by day, 
first the raw data is aggregated to daily averages by the 5 minute intervals. 

```{r}
stepsby5 <- dfa %>%
        drop_na() %>%
        group_by(interval) %>%
        summarise(meansteps=mean(steps))
head(stepsby5)
```

The average daily pattern is shown in a time series plot below. 

```{r}
plot(stepsby5$interval, stepsby5$meansteps, type="l", xlab="Time (by 5 min intervals)",
     ylab="average number of steps", main="Average number of steps by time stamp")
```

The highest amount of steps taken daily on average (`r maxsteps5`) is found at 
time stamp `r maxinterval`. 

```{r}
maxsteps5 <- max(stepsby5$meansteps)
maxinterval <- as.numeric(stepsby5[stepsby5$meansteps==maxsteps5,"interval"])
```



